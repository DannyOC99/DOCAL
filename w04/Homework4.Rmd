---
title: "Homework 4: Modifying and Plotting the Penguin Dataset"
author: "Daniel OCallaghan"
date: ""
output:
  html_document: 
    toc: yes
    toc_depth: 4
    toc_float: yes
    fig_width: 6
    fig_caption: yes
    number_sections: yes
    toc_collapsed: yes
    code_folding: hide
    code_download: yes
    smooth_scroll: true
    theme: readable
  pdf_document: 
    toc: yes
    toc_depth: 4
    fig_caption: yes
    number_sections: yes
    fig_width: 5
    fig_height: 4
---
<style type="text/css">

/* Table of content - navigation */
div#TOC li {
    list-style:none;
    background-color:black;
    background-image:none;
    background-repeat:none;
    background-position:0;
    font-family: Arial, Helvetica, sans-serif;
    color: lightblue;
}

h1.title {
  font-size: 24px;
  color: Navy;
  text-align: center;
}

h4.author { /* Header 4 - and the author and data headers use this too  */
    font-size: 18px;
  font-family: "Times New Roman", Times, serif;
  color: blue;
  text-align: center;
}
h4.date { /* Header 4 - and the author and data headers use this too  */
  font-size: 18px;
  font-family: "Times New Roman", Times, serif;
  color: blue;
  text-align: center;
}
h1 { /* Header 3 - and the author and data headers use this too  */
    font-size: 22px;
    font-family: "Times New Roman", Times, serif;
    color: blue;
    text-align: center;
}
h2 { /* Header 3 - and the author and data headers use this too  */
    font-size: 18px;
    font-family: "Times New Roman", Times, serif;
    color: Navy;
    text-align: left;
}

h3 { /* Header 3 - and the author and data headers use this too  */
    font-size: 15px;
    font-family: "Times New Roman", Times, serif;
    color: Navy;
    text-align: left;
}

h4 { /* Header 4 - and the author and data headers use this too  */
    font-size: 18px;
    font-family: "Times New Roman", Times, serif;
    color: Navy;
    text-align: left;
}
</style>

```{r setup, include=FALSE}
if (!require("readr")) {
   install.packages("readr")
   library(readr)
}
if (!require("tidyverse")) {
   install.packages("tidyverse")
   library(tidyverse)
}
if (!require("knitr")) {
   install.packages("knitr")
   library(knitr)
}
if (!require("cowplot")) {
   install.packages("cowplot")
   library(cowplot)
}
if (!require("latex2exp")) {
   install.packages("latex2exp")
   library(latex2exp)
}
if (!require("plotly")) {
   install.packages("plotly")
   library(plotly)
}
if (!require("gapminder")) {
   install.packages("gapminder")
   library(gapminder)
}
if (!require("png")) {
    install.packages("png")             # Install png package
    library("png")
}
if (!require("RCurl")) {
    install.packages("RCurl")             # Install RCurl package
    library("RCurl")
}
if (!require("colourpicker")) {
    install.packages("colourpicker")              
    library("colourpicker")
}
if (!require("gganimate")) {
    install.packages("gganimate")              
    library("gganimate")
}
if (!require("gifski")) {
    install.packages("gifski")              
    library("gifski")
}
if (!require("magick")) {
    install.packages("magick")              
    library("magick")
}
if (!require("grDevices")) {
    install.packages("grDevices")              
    library("grDevices")
}
if (!require("jpeg")) {
    install.packages("jpeg")              
    library("jpeg")
}
if (!require("VGAM")) {
    install.packages("VGAM")              
    library("VGAM")
}
if (!require("MASS")) {
    install.packages("MASS")              
    library("MASS")
}
if (!require("nnet")) {
    install.packages("nnet")              
    library("nnet")
}
if (!require("cluster")) {
    install.packages("cluster")              
    library("cluster")
}

# knitr::opts_knit$set(root.dir = "C:\\STA490\\w05")
knitr::opts_chunk$set(echo = TRUE,       
                      warning = FALSE,   
                      result = TRUE,   
                      message = FALSE,
                      comment = NA)
```

```{r dataset, include=FALSE}
penguin<-read.csv(file="https://dannyoc99.github.io/DOCAL/dataset/w03-penguins.csv")
```

# Modifying the dataset

## Getting Rid of Missing Records

```{r missing}
penguin.nomiss<-na.omit(penguin)
```

## Filter on Penguin Species and Island Location

```{r filtered}
Limited_penguin<-filter(penguin.nomiss,species=="Adelie" | species=="Gentoo") %>% filter(island=="Biscoe" | island=="Torgersen")%>%filter(3500<body_mass_g & body_mass_g<5000)
```

## Rescale Body Mass to BMI

```{r BMI}
BMI_Penguin<-mutate(Limited_penguin,BMI=body_mass_g/4000)
```

## Creating the Final Dataset to Graph

```{r keep}
Graph_Penguin<-BMI_Penguin[-c(1,7,8,9)]
Gentoo<-filter(Graph_Penguin,species=="Gentoo")
Adelie<-filter(Graph_Penguin,species=="Adelie")
```

# Dataset used for graph

```{r data}
DT::datatable(Graph_Penguin, fillContainer = FALSE, options = list(pageLength = 11))
```

# Graphing Flipper Length vs Bill Length by Species

```{r plot}

penguin.img <- "https://dannyoc99.github.io/DOCAL/img/penguin.jpeg"
my.penguin <- readJPEG(getURLContent(penguin.img))
raster.penguin <- as.raster(my.penguin) 
# Define Necessary Variables
penguin.bill_length = Graph_Penguin$bill_length_mm
penguin.flipper = Graph_Penguin$flipper_length_mm
penguin.BMI = Graph_Penguin$BMI
species = Graph_Penguin$species
## identifying the ID of Penguins
Adelie.id = which(species=="Adelie") 
Gentoo.id = which(species=="Gentoo")
plot(penguin.bill_length, penguin.flipper,xlab="Bill Length (mm)",ylab="Flipper Length (mm)", main = "Flipper Length vs Bill Length by Species", type = "n")
## change the point size based on their average of sepal length and width
points(penguin.bill_length[Adelie.id], penguin.flipper[Adelie.id], 
       pch = 4, col = "black", cex = penguin.BMI[Adelie.id], alpha = 0.6)
points(penguin.bill_length[Gentoo.id], penguin.flipper[Gentoo.id], 
       pch = 19, col = "orange", cex = penguin.BMI[Gentoo.id], alpha = 0.6)
legend("topleft", c("Adelie", "Gentoo"), 
                  col=c("black", "orange"),
                  pch=c(4, 19))
## various annotations
#specify the position of the image through bottom-left and top-right coords
rasterImage(raster.penguin,47,180,50,192)
text(38, 205, "Size proportional to Body Mass (g)", col = "Black", cex = .7)
abline(lm(Adelie$flipper_length_mm~Adelie$bill_length_mm),col="black")
abline(lm(Gentoo$flipper_length_mm~Gentoo$bill_length_mm),col="orange")
```




Here we see a Plot of Flipper Length vs Bill Length by Species. Each species is given its own set of colors and point type to demonstrate the efect species has on the relationship of bill length and flipper length. Additionally, the BMI of the penguins within its species was used to create the size of the points. From what we can see, visualizing without accounting for species would indicate a weak linear relationship, but taking into account Species we see a strong relationship between Flipper Length and Bill Length. This is especially visible by how the regression lines we added go through the data hitting most of the points, where any points it does not hit being close to the line. The one exception to this, the point around 44,209 for the Adelie penguins is most likely an outlier 
